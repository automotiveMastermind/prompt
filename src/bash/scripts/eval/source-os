#! /usr/bin/env bash

__am_prompt_source_os() {

	if [ -f /etc/os-release ]; then
		. /etc/os-release
		UNAMES="$ID ${ID_LIKE:-unknown} linux"
	else
		UNAMES=$(uname | tr '[:upper:]' '[:lower:]')
	fi

	UNAME=
	until [ "$UNAME" = "$UNAMES" ]; do
		UNAME=${UNAMES%%' '*}
		UNAMES=${UNAMES#*' '}

		UNAME_PATH="$HOME/.am/prompt/bash/scripts/$UNAME"

		if [ ! -d "$UNAME_PATH" ]; then
			continue
		fi

		export AM_PROMPT_OS=$UNAME
		export PATH="$UNAME_PATH:$PATH"

		if [ -d "$UNAME_PATH/eval" ]; then
			for EVAL_SCRIPT in "$UNAME_PATH"/eval/*; do
				. "$EVAL_SCRIPT"
			done
		fi

		break
	done
}

__am_prompt_source_os
